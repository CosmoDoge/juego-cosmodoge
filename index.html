<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Juego CosmoDoge üöÄ</title>
  <style>
    * { margin: 0; padding: 0; box-sizing: border-box; }
    html, body {
      height: 100%;
      background: black;
      font-family: Arial, sans-serif;
      overflow: hidden;
    }
    canvas {
      display: block;
      margin: auto;
      background-color: black;
    }
    #scoreDisplay, #highScoreDisplay {
      position: absolute;
      top: 10px;
      left: 10px;
      color: white;
      font-size: 22px;
      font-weight: bold;
      text-shadow: 2px 2px 5px #000;
    }
    #highScoreDisplay {
      top: 40px;
    }
    #startScreen, #gameOverScreen {
      position: absolute;
      top: 0; left: 0;
      width: 100%; height: 100%;
      background-color: rgba(0,0,0,0.9);
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      color: white;
      z-index: 10;
      text-align: center;
    }
    h1 {
      font-size: 2rem;
      margin-bottom: 1rem;
    }
    button {
      padding: 1rem 2rem;
      background-color: #00ffff;
      border: none;
      border-radius: 10px;
      color: black;
      font-size: 1.1rem;
      font-weight: bold;
      cursor: pointer;
      transition: background-color 0.3s ease;
    }
    button:hover {
      background-color: #00e7f5;
    }
  </style>
</head>
<body>
  <canvas id="gameCanvas" width="480" height="640"></canvas>
  <div id="scoreDisplay">üöÄ x 0</div>
  <div id="highScoreDisplay">üîù M√°x: 0</div>
  <div id="startScreen">
    <h1>üöÄ Bienvenido al juego de CosmoDoge</h1>
    <button id="startButton">Jugar</button>
  </div>
  <div id="gameOverScreen" style="display: none;">
    <h1>üí• Game Over</h1>
    <p id="finalScore">Tu puntaje: 0</p>
    <p id="recordScore">Record: 0</p>
    <button onclick="reiniciarJuego()">Volver a jugar</button>
  </div>

<script>
const canvas = document.getElementById("gameCanvas");
const ctx = canvas.getContext("2d");

let isMobile = /iPhone|iPad|Android/i.test(navigator.userAgent);
if (isMobile) {
  canvas.width = window.innerWidth;
  canvas.height = window.innerHeight;
}

// IM√ÅGENES
const fondos = ["fondo-cosmodoge-v2.png", "fondo-cosmodoge-v3.png", "fondo-cosmodoge-v4.png"];
let fondo = new Image();
fondo.src = fondos[Math.floor(Math.random() * fondos.length)];

const doge = {
  x: 80,
  y: 200,
  width: 50,
  height: 50,
  velocity: 0,
  img: new Image()
};
doge.img.src = "cosmodoge-cohete-juego.png";

const obstaculosImgs = [
  "obstaculo1.png", "obstaculo2.png", "obstaculo3.png",
  "obstaculo4.png", "obstaculo5.png", "obstaculo6.png"
];

let obstaculos = [];
let score = 0;
let highScore = parseInt(localStorage.getItem("cdogeHighScore")) || 0;
let isGameOver = false;
let gameStarted = false;
const gravity = 0.5;
const jump = -10;
const gap = 140;
const pipeWidth = 60;
let frame = 0;

const scoreDisplay = document.getElementById("scoreDisplay");
const highScoreDisplay = document.getElementById("highScoreDisplay");
const startScreen = document.getElementById("startScreen");
const gameOverScreen = document.getElementById("gameOverScreen");
const finalScore = document.getElementById("finalScore");
const recordScore = document.getElementById("recordScore");

highScoreDisplay.textContent = "üîù M√°x: " + highScore;

function drawBackground() {
  ctx.drawImage(fondo, 0, 0, canvas.width, canvas.height);
}

function drawDoge() {
  ctx.drawImage(doge.img, doge.x, doge.y, doge.width, doge.height);
}

function drawObstacles() {
  obstaculos.forEach((obs) => {
    ctx.drawImage(obs.img, obs.x, obs.y, pipeWidth, obs.height);
    ctx.drawImage(obs.img, obs.x, obs.y + obs.height + gap, pipeWidth, canvas.height);
  });
}

function updateObstacles() {
  if (frame % 100 === 0) {
    const height = Math.floor(Math.random() * 250) + 50;
    const img = new Image();
    img.src = obstaculosImgs[Math.floor(Math.random() * obstaculosImgs.length)];
    obstaculos.push({
      x: canvas.width,
      y: 0,
      height: height,
      img: img,
      passed: false
    });
  }

  obstaculos.forEach((obs) => {
    obs.x -= 2;
    if (
      doge.x < obs.x + pipeWidth &&
      doge.x + doge.width > obs.x &&
      (doge.y < obs.height || doge.y + doge.height > obs.height + gap)
    ) {
      isGameOver = true;
      mostrarGameOver();
    }

    if (!obs.passed && obs.x + pipeWidth < doge.x) {
      score++;
      obs.passed = true;
      scoreDisplay.textContent = "üöÄ x " + score;
    }
  });

  obstaculos = obstaculos.filter((obs) => obs.x + pipeWidth > 0);
}

function mostrarGameOver() {
  if (score > highScore) {
    highScore = score;
    localStorage.setItem("cdogeHighScore", score);
  }
  finalScore.textContent = "Tu puntaje: " + score;
  recordScore.textContent = "Record: " + highScore;
  gameOverScreen.style.display = "flex";
}

function update() {
  if (!gameStarted || isGameOver) return;

  ctx.clearRect(0, 0, canvas.width, canvas.height);
  drawBackground();

  doge.velocity += gravity;
  doge.y += doge.velocity;

  if (doge.y + doge.height >= canvas.height || doge.y <= 0) {
    isGameOver = true;
    mostrarGameOver();
  }

  drawDoge();
  drawObstacles();
  updateObstacles();
  frame++;
  requestAnimationFrame(update);
}

function reiniciarJuego() {
  location.reload();
}

document.addEventListener("keydown", (e) => {
  if (e.code === "Space") {
    if (isGameOver) return;
    doge.velocity = jump;
  }
});

if (isMobile) {
  document.addEventListener("touchstart", () => {
    if (isGameOver) return;
    doge.velocity = jump;
  });
}

document.getElementById("startButton").onclick = () => {
  startScreen.style.display = "none";
  gameStarted = true;
  update();
};
</script>
</body>
</html>
