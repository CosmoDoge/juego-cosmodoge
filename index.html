<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Juego CosmoDoge ðŸš€</title>
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }
    body {
      overflow: hidden;
      background: black;
    }
    canvas {
      display: block;
      margin: auto;
      background: black;
    }
    #startButton {
      position: absolute;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      padding: 1rem 2rem;
      font-size: 1.2rem;
      background: #00ffff;
      border: none;
      border-radius: 10px;
      cursor: pointer;
      z-index: 2;
    }
    #score {
      position: absolute;
      top: 10px;
      left: 10px;
      color: white;
      font-size: 24px;
      font-family: Arial, sans-serif;
      z-index: 1;
    }
  </style>
</head>
<body>
  <div id="score">ðŸš€ x 0</div>
  <button id="startButton">Jugar</button>
  <canvas id="gameCanvas" width="480" height="640"></canvas>

  <script>
    const canvas = document.getElementById("gameCanvas");
    const ctx = canvas.getContext("2d");
    const startButton = document.getElementById("startButton");
    const scoreDisplay = document.getElementById("score");

    const gravity = 0.5;
    const jump = -10;
    const gap = 140;

    let doge, obstacles, score, isGameOver, gameStarted;
    let backgroundImages = ["fondo-cosmodoge-v2.png", "fondo-cosmodoge-v3.png", "fondo-cosmodoge-v4.png"];
    let backgroundIndex = 0;
    let backgroundX = 0;
    let backgroundSpeed = 1;

    const obstacleImages = [
      "obstaculo1.png",
      "obstaculo2.png",
      "obstaculo3.png",
      "obstaculo4.png",
      "obstaculo5.png",
      "obstaculo6.png"
    ];

    const dogeImg = new Image();
    dogeImg.src = "cosmodoge-cohete-juego.png";

    function resetGame() {
      doge = {
        x: 80,
        y: canvas.height / 2,
        width: 50,
        height: 50,
        velocity: 0
      };
      obstacles = [];
      score = 0;
      isGameOver = false;
      backgroundIndex = 0;
      backgroundX = 0;
    }

    function drawBackground() {
      let bg = new Image();
      bg.src = backgroundImages[backgroundIndex];
      ctx.drawImage(bg, backgroundX, 0, canvas.width, canvas.height);
      ctx.drawImage(bg, backgroundX + canvas.width, 0, canvas.width, canvas.height);

      backgroundX -= backgroundSpeed;
      if (backgroundX <= -canvas.width) {
        backgroundX = 0;
        backgroundIndex = (backgroundIndex + 1) % backgroundImages.length;
      }
    }

    function drawDoge() {
      ctx.drawImage(dogeImg, doge.x, doge.y, doge.width, doge.height);
    }

    function drawObstacles() {
      for (let i = 0; i < obstacles.length; i++) {
        let obs = obstacles[i];
        ctx.drawImage(obs.img, obs.x, obs.y, obs.width, obs.height);
        obs.x -= 2;

        // Verifica colisiÃ³n
        if (
          doge.x < obs.x + obs.width &&
          doge.x + doge.width > obs.x &&
          doge.y < obs.y + obs.height &&
          doge.y + doge.height > obs.y
        ) {
          isGameOver = true;
        }
      }

      // Agregar nuevo obstÃ¡culo
      if (obstacles.length === 0 || obstacles[obstacles.length - 1].x < canvas.width - 200) {
        const height = Math.floor(Math.random() * 250) + 50;
        const yPos = Math.random() > 0.5 ? 0 : canvas.height - height;
        const img = new Image();
        img.src = obstacleImages[Math.floor(Math.random() * obstacleImages.length)];

        obstacles.push({
          x: canvas.width,
          y: yPos,
          width: 50,
          height: height,
          img: img
        });
      }

      // Eliminar obstÃ¡culos pasados
      if (obstacles.length > 0 && obstacles[0].x + obstacles[0].width < 0) {
        obstacles.shift();
        score++;
      }
    }

    function update() {
      if (isGameOver) {
        startButton.style.display = "block";
        scoreDisplay.textContent = `ðŸš€ x ${score}`;
        return;
      }

      ctx.clearRect(0, 0, canvas.width, canvas.height);

      drawBackground();
      doge.velocity += gravity;
      doge.y += doge.velocity;

      drawDoge();
      drawObstacles();

      if (doge.y + doge.height > canvas.height || doge.y < 0) {
        isGameOver = true;
        startButton.style.display = "block";
      }

      scoreDisplay.textContent = `ðŸš€ x ${score}`;
      requestAnimationFrame(update);
    }

    document.addEventListener("keydown", () => {
      if (!gameStarted) return;
      if (!isGameOver) {
        doge.velocity = jump;
      } else {
        startButton.style.display = "block";
      }
    });

    startButton.addEventListener("click", () => {
      gameStarted = true;
      startButton.style.display = "none";
      resetGame();
      update();
    });
  </script>
</body>
</html>
